kind: Suite
apiVersion: test.gatekeeper.sh/v1alpha1
metadata:
  name: upgradeconfig
tests:
- name: upgradeconfig-tests
  template: ../../gktemplates/aro-deny-upgradeconfig.yaml
  constraint: ../../gkconstraints-test/aro-upgradeconfig.yaml
  cases:
  - name: create-upgradeconfig-allowed-regular-user
    object: gator-test/allow_regular_user_create_managed_upgrade_operator.yaml
    assertions:
    - violations: no
  - name: create-upgradeconfig-allowed-system-user
    object: gator-test/allow_system_user_create_managed_upgrade_operator.yaml
    assertions:
    - violations: no
  - name: create-upgradeconfig-not-allowed-regular-user
    object: gator-test/not_allow_regular_user_create_managed_upgrade_operator.yaml
    assertions:
    - violations: yes
  - name: update-upgradeconfig-allowed-regular-user
    object: gator-test/allow_regular_user_update_managed_upgrade_operator.yaml
    assertions:
    - violations: no
  - name: update-upgradeconfig-allowed-system-user
    object: gator-test/allow_system_user_update_managed_upgrade_operator.yaml
    assertions:
    - violations: no
  - name: update-upgradeconfig-allowed-regular-user
    object: gator-test/not_allow_regular_user_update_managed_upgrade_operator.yaml
    assertions:
    - violations: yes
  - name: delete-upgradeconfig-allowed-regular-user
    object: gator-test/allow_regular_user_delete_managed_upgrade_operator.yaml
    assertions:
    - violations: no
  - name: delete-upgradeconfig-allowed-system-user
    object: gator-test/allow_system_user_delete_managed_upgrade_operator.yaml
    assertions:
    - violations: no
  - name: delete-upgradeconfig-allowed-regular-user
    object: gator-test/not_allow_regular_user_delete_managed_upgrade_operator.yaml
    assertions:
    - violations: yes