apiVersion: constraints.gatekeeper.sh/v1beta1
kind: AROPrivilegedNamespace
metadata:
  name: aro-privileged-namespace-deny
spec:
  enforcementAction: {{.Enforcement}}
  match:
    kinds:
      - apiGroups: [""]
        kinds: [
        "Pod",
        "Secret",
        "Service",
        "ServiceAccount",
        "ReplicationController",
        "ResourceQuota",
        "PersistentVolume",
        "PersistentVolumeClaim"
        ]
      - apiGroups: ["apps"]
        kinds: ["Deployment", "ReplicaSet", "StatefulSet", "DaemonSet"]
      - groups: ["batch"]
        kinds: ["Job", "CronJob"]
      - groups: ["rbac.authorization.k8s.io"]
        kinds: ["Role", "RoleBinding", "ClusterRole", "ClusterRoleBinding"]
      - groups: ["policy"]
        kinds: ["PodSecurityPolicy", "PodDisruptionBudget"]
      - groups: ["apiextensions"]
        kinds: ["CustomResourceDefinition"]
