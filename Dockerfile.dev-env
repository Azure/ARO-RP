# Use Fedora as base image since the project documentation mentions Fedora/RHEL dependencies
FROM fedora:41

# Install system dependencies
RUN dnf update -y && dnf install -y \
    gpgme-devel \
    libassuan-devel \
    openssl \
    openssl-devel \
    openssl-libs \
    lvm2 \
    lvm2-devel \
    golang-github-containerd-btrfs-devel \
    bzip2-devel \
    ncurses-devel \
    libffi-devel \
    readline-devel \
    sqlite-devel \
    tk-devel \
    xz-devel \
    zlib-devel \
    gcc \
    make \
    patch \
    openvpn \
    podman \
    podman-docker \
    git \
    curl \
    wget \
    python3-pip \
    which \
    && dnf clean all

# Set up working directory
WORKDIR /workspace

# Copy entrypoint script
COPY dev-container-entrypoint.sh /dev-container-entrypoint.sh
RUN chmod +x /dev-container-entrypoint.sh

ENTRYPOINT ["/dev-container-entrypoint.sh"]