parameters:
  dst_acr_name: ""
  mirrorTag: ""
steps:
  - script: |
      go run ./cmd/aro mirror ${{ parameters.mirrorTag }}

      source ./hack/rp-dev-helper.sh
      mdm_image_tag=$(get_digest_tag "MdmImage")
      mdsd_image_tag=$(get_digest_tag "MdsdImage")

      az acr import --name ${{ parameters.dst_acr_name }}.azurecr.io/${mdm_image_tag} --source linuxgeneva-microsoft.azurecr.io/${mdm_image_tag}
      az acr import --name ${{ parameters.dst_acr_name }}.azurecr.io/${mdsd_image_tag} --source linuxgeneva-microsoft.azurecr.io/${mdsd_image_tag}
    name: mirror-ocp-images-to-acr
    displayName: ⚙️ Mirror OCP Images to ACR
