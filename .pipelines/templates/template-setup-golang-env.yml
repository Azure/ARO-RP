parameters:
  GOBIN: $(GOBIN)
  GOROOT: $(GOROOT)
  GOPATH: $(GOPATH)
  modulePath: $(modulePath)
steps:
- script: |
    mkdir -p '${{ parameters.GOBIN}}'
    mkdir -p '${{ parameters.GOPATH}}/pkg'
    mkdir -p '${{ parameters.modulePath}}'
    shopt -s extglob
    shopt -s dotglob
    mv !(gopath) '${{ parameters.modulePath}}'
    echo '##vso[task.prependpath]${{ parameters.GOBIN}}'
    echo '##vso[task.prependpath]${{ parameters.GOROOT}}/bin'
    go version
    go get github.com/jstemmer/go-junit-report
    go get github.com/axw/gocov/gocov
    go get github.com/AlekSi/gocov-xml
    go get -u gopkg.in/matm/v1/gocov-html
    sudo add-apt-repository ppa:kubuntu-ppa/backports
    sudo apt-get update
    sudo apt-get install libgpgme-dev gcc -y
  displayName: '⚙️Set up the workspace'