parameters:
    kvName: ''
    certName: ''
    outputPath: ''
steps:
    - script: |
        az keyvault secret show --vault-name ${{ parameters.kvName }} -n ${{ parameters.certName }} --query value -o tsv > ${{ parameters.outputPath }}.pem
        openssl pkey -in ${{ parameters.outputPath }}.pem -out ${{ parameters.outputPath }}-key.pem
        openssl rsa -in ${{ parameters.outputPath }}.pem -pubout -out ${{ parameters.outputPath }}-cert.pem
      displayName: "ğŸ”‘ Downloading certificate ${{ parameters.certName }} and creating public key and private key files"