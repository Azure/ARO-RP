apiVersion: v1
data:
  # Configuration detail can be found here.
  # https://identitydivision.visualstudio.com/DevEx/_git/Microsoft-IdentityModel-S2S?path=/docs/JsonConfigurations.md&_a=preview
  appsettings.json: |
    {
      "Version": "1",
      "AzureAd": {
        "Instance": {{ .Values.MISE.configMap.Instance }},
        "ClientId": {{ .Values.MISE.configMap.ClientId }},
        "TenantId": {{ .Values.MISE.configMap.TenantId }},
        "InboundPolicies": 
        [
          {
            "Label": {{ .Values.MISE.configMap.InboundPolicies.Label }},
            "AuthenticationSchemes": {{ .Values.MISE.configMap.InboundPolicies.AuthenticationSchemes }},
            "ValidAudiences" : [ 
                {{ .Values.MISE.configMap.ClientId }}
            ] 
          }
        ],
      },
      "AllowedHosts": {{ .Values.MISE.configMap.AllowedHosts }},
      "Kestrel": {
        "Endpoints": {
            "Http": {
                "Url": {{ .Values.MISE.configMap.AllowedHosts }}
            }
        }
      }
    }
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: {{ .Values.MISE.container.volumes.configMap.name }}
  data:
  log_level:  {{ .Values.MISE.container.volumes.configMap.log_level }}